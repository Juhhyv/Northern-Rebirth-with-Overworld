#textdomain wesnoth-nr

[scenario]
    id=01_Breaking_the_Chains
    name= _ "Breaking the Chains"
    map_file=01_Breaking_the_Chains.map
    {TURNS 41 32 27 25}
    next_scenario=openwordl
	carryover_percentage=40%

    {DEFAULT_SCHEDULE}

   
    [story]
        [part]
            story= _ "Far to the north of Wesnoth, and hard by the dwarven caves of Knalga, there was once a thriving mixed community known as Dwarven Doors. Food, wood, and cloth from all over Wesnoth and many elvish lands as well were brought here to be sold to the dwarves, while ores, metals and worked dwarven manufactures were bought here to be traded throughout the surface nations. Dwarves and humans worked and lived side by side; even the elves who came to trade mingled more with the other kindred races than was common elsewhere. Dwarven Doors grew populous and wealthy."
		background="story.jpg"
            
        [/part]
        [part]
            story= _ "The dwarves of Knalga, cannily reckoning the gains from trade, built strong fortifications around Dwarven Doors. The dwarves and humans who called it home knew that the wealth of the city might arouse envy from afar — hence they kept their weapons sharp, and regarded themselves able to fight off any bandit gang or petty warlord."
	background="story.jpg"

        [/part]
        [part]
            story= _ "For many years it was indeed so. Dwarven Doors was a peaceful and prosperous place until the orcs came..."
	background="story.jpg"
           
        [/part]
        [part]
            story= _ "At first, the incursions were mere rabble that were easily felled. Complacent in their own prowess, the people of the Dwarven Doors ignored the orcs even as the raids grew more numerous and threatening. With time, the raiding parties grew into war bands; then at last, there arose a mighty warlord of the Bloody Sword tribe, Khazg Black-Tusk, who surrounded the entirety of their defenses with a great host of warriors."
	background="story.jpg"
        [/part]
        [part]
            story= _ "It was a time of doom and great deeds, of fire and blood and slaughter. The men and dwarves fought valiantly. But there were always, it seemed, more orcs to replace the slain, while the defenders could find no succor. Pleas for help went unheeded in other lands for men, elves, and even dwarves, were wrapped up in their own affairs and struggles or deemed the orcs too far away to bring unto them harm."
	background="story.jpg"
        [/part]
        [part]
            story= _ "After a year and a day of grim battle, the city fell. The streets of the Dwarven Doors ran with gore. The dwarves retreated into the caverns Knalga, but the humans who survived were enslaved. Cut off from contact with the surface, the dwarves of Knalga fought on, but knew their subjugation could not be averted forever."
	background="story.jpg"
            
        [/part]
        [part]
            story= _ "Dark years passed; human generations grew up and died in slavery, and with every passing year came closer to forgetting that their ancestors had ever been free. They might have completely forgotten were it not for a fateful day. The day that changed the lives of the people of Dwarven Doors — forever."
	background="story.jpg"
        [/part]
        [part]
           
            story= _ "It was an early spring day, in the year 518YW. The humans — joyless beneath the orcish whip — were dispiritedly planting the yearly crop. All at once, the war-drums of the orcs began pounding; harsh war-cries sounded as orcs mustered to gather their weapons and man their posts. Startled, the peasants looked around in alarm, and that was when they saw him."
	background="story.jpg"
        [/part]
        [part]
            story= _ "He came charging out of the woods, his cape streaming in the breeze, his sword flashing quicker than thought. All around him, the hated orcs fell. To his right fought an elderly mage whose deep voice boomed incantations over the clamor of the battle. To his left, glowing with faerie fire, was a great lord of the elves. They were followed closely by a small but powerful elvish army."
           background="story.jpg"
        [/part]
        [part]
            # po: tyrant -> Queen Asheviere from Heir to the Throne.
            story= _ "Word quickly spread among the humans that this hero was none other than Prince Konrad of Wesnoth, faring to the ruins of Knalga to retrieve the Sceptre of Fire and use it to save his homeland from the rule of a tyrant, and they stood, rooted to their places in awe."
	background="story.jpg"
        [/part]
        [part]
            story= _ "As quickly as it had begun, it was over. Konrad reached the entrance to the tunnels and ushered his men through. Then he turned one last time to face the peasants. Raising his sword in salute and farewell, he called out to them: <i>“Hold fast your hope, for one day you shall be free!”</i> Then he was gone."
	background="story.jpg"
        [/part]
        [part]
            story= _ "After that day, nothing could be the same. Hope rose in their hearts like a flame long-smothered but rekindled. The brightest and boldest of them began to plan and to train in secret. And the orcish masters, grown stupid from their own arrogance, did not see."
	background="story.jpg"
        [/part]
        [part]
            # wmllint: local spelling weaponsmith
            story= _ "There was one among these peasants named Tallin. He had been a little child, barely out of his mother’s arms, when Konrad broke the Orcish host. But he never forgot that day. His father was a weaponsmith, his family used less brutally than most because the orcish masters put more value on that craft. In secret, his mother even taught him letters. As the boy grew to young manhood, he could touch blades, and dream. And he did."
            background="story.jpg"
        [/part]
        [part]
            story= _ "Then one day Al’Tar, the current ‘master’ of Dwarven Doors, was attacked by a neighboring tribe of orcs. Tallin seized his moment. Using knowledge born of years of watching, listening, and planning, he managed to steal a few weapons and a small amount of Al’Tar’s gold. He fled to an abandoned ruin in the forest to rally his fellow peasants."
        [/part]
    [/story]

    #Player side
    [side]
        side=1
        controller=human
        recruit=Peasant,Woodsman
	save_id=talin
        {GOLD 100 100 100 200}
        team_name=rebels
        user_team_name= _ "Talin"
        {FLAG_VARIANT6 ragged}

       [unit]
			facing="ne"
			name=_"Talin"
			side=1
			type="Peasant"
			id=talin
			profile=talin.png
			x=7
			y=24
			[modifications]
				{TRAIT_INTELLIGENT}
				{TRAIT_RESILIENT}
			[/modifications]
			canrecruit=yes
			extra_recruit=Peasant, Woodsman, Ruffian

			[abilities]
       				 {ABILITY_SKIRMISHER}
  			 [/abilities]

		[/unit]
        [unit]
            type=Peasant
            id=Zlex
            name= _ "Zlex"
            unrenamable=yes
            x,y=6,24
            role=Supporter
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
        [/unit]
    [/side]
   

    # First of the orcish opponents, recruits simple L1 mix with no trolls
    [side]
        side=2
        controller=ai
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider
        {GOLD 200 250 350 800}
        team_name=slavers
        user_team_name= _ "Al'Tar"
        {FLAG_VARIANT6 ragged}

        type=Orcish Warlord
        id="Al'Tar"
        name= _ "Al’Tar"
        canrecruit=yes

        [ai]
            village_value=0.75	# Weakened desire to capture villages
            caution=0.50	    # Wants to survive the duel
            [goal]
                name=target
                [criteria]
                    side=3
                [/criteria]
                value=3
            [/goal]
            [goal]
                name=target
                [criteria]
                    side=1
                [/criteria]
                value=1
            [/goal]
        [/ai]
    [/side]

    # Second orcish opponent
    [side]
        side=3
        controller=ai
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider
        {GOLD 200 250 350 800}
        team_name=invaders
	color=purple
        user_team_name= _ "Garrugch"
        {FLAG_VARIANT6 ragged}

        type=Orcish Warrior
        id=Garrugch
        name= _ "Garrugch"
        canrecruit=yes

        [ai]
            leader_value=5	    # Strong desire to kill Al'Tar
            village_value=0.75	# Weakened desire to capture villages
            caution=0.50	    # Wants to survive the duel
            [goal]
                name=target
                [criteria]
                    side=2
                [/criteria]
                value=3
            [/goal]
            [goal]
                name=target
                [criteria]
                    side=1
                [/criteria]
                value=1
            [/goal]
        [/ai]
    [/side]

    
    {STARTING_VILLAGES 1 6}
    {STARTING_VILLAGES 2 7}
    {STARTING_VILLAGES 3 6}

    {PLACE_IMAGE scenery/dwarven-doors-closed.png 32 4}

    [event]
        name=prestart

        [objectives]
            side=1
            [objective]
                description= _ "Defeat enemy leaders"
                condition=win
            [/objective]
		[objective]
                description= _ "Or move Talin to mine doors (32,4) 20% gold carryover"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Talin"
                condition=lose
            [/objective]
		note= _ "Talin has a special advancement"
            {TURNS_RUN_OUT}

            [gold_carryover]
                bonus=yes
                carryover_percentage=40
            [/gold_carryover]
        [/objectives]
    [/event]

    [event]
        name=start
	#set some variables to use later
	{SETVARIABLES}
	
#Give Talin special advancement
	[modify_unit]
		[filter]
			id=talin
		[/filter]
		[effect]
			apply_to=new_advancement
			types= Frontline Sergeant
		[/effect]
	[/modify_unit]

	#Talk

        [message]
            speaker=talin
            message= _ "This challenger has made the orcs careless — I managed to sneak in and filch the key to the storerooms. Come with me lads, and grab some weapons! Let them hack at each other, we can use this as our chance to get rid of this scum once and for all. Who’s with me?"
        [/message]

        [message]
            speaker=Zlex
            message= _ "Brave words, Tallin, but if I didn’t know you better I’d say you were moon-touched. These are not weapons, just pitchforks and hunting bows. We have no armor, no training. Are we supposed to beat them with bad breath and colorful language?"
        [/message]

        [message]
            speaker=talin
            message= _ "Well, those things will certainly get their attention, but there’s nothing wrong with pitchforks. We easily outnumber the orcs and they’re even now killing each other."
        [/message]

        [message]
            speaker=Zlex
            message= _ "But their wolves run faster than we can walk, and their swords are sharper than these farm tools."
        [/message]

        [message]
            speaker=talin
            message= _ "Our numbers are our strength. Stay shoulder-to shoulder with the man next to you; never get isolated, especially not on open ground. Swarm them — surround them, five or six to one, and they will go down."
        [/message]

        [message]
            speaker=Zlex
            message= _ "But still, Tallin, this is going to be a slaughter."
        [/message]

        [message]
            speaker=talin
            message= _ "But, but, but... Are you full of nothing but doubts? (<i>Sigh</i>) Yes, it will be a massacre. But would you rather live as slaves to the orcs forever?"
        [/message]

        [message]
            speaker=Zlex
            message= _ "Never! I would rather die!"
        [/message]

        [message]
            speaker=talin
            message= _ "Then what choice do we have? This may be the only chance we ever get, it’s time to fight!"
        [/message]

        [message]
            speaker="Al'Tar"
            message= _ "You dare greatly, you miserable excuse for an orc! How dare you step onto my land!"
        [/message]

        [message]
            speaker=Garrugch
            message= _ "Your land? Bloody Sword enslaved people of Dwarven Doors. You barely take control of it when we were distracted elsewhere. Decades you have keep our territory and slaves. Now it ends!"
        [/message]

        [message]
            speaker="Al'Tar"
            message= _ "Pah! Grunts, attack! Whoever brings me the head of Garrugch will be rewarded in gold!"
        [/message]
    [/event]

    # Flavor event. On first player attack against the wardens (side 2) perform a dialog.
    [event]
        name=attack
        [filter]
            side=1
        [/filter]
        [filter_second]
            side=2
        [/filter_second]

        [message]
            speaker=second_unit
            message= _ "Ack! These bloody slaves are always getting in the way. Cut them down!"
        [/message]

        [message]
            speaker=Garrugch
            message= _ "Look at that, the weakling Al’Tar can’t even keep his slaves under control. This will prove easier than I thought!"
        [/message]
    [/event]

#hint to player
	[event]
		name=turn 2
		[message]
            		speaker=talin
        	    message= _ "Don't rush to fight. We should capture villages and prepraire troops while orcs kill each other. When we are ready, we can either escape thought doors or defeat Al’Tar and Garrugch."
       		 [/message]

	[/event]

#Escape underground 
    [event]
	name=moveto
	[filter]
		id=talin
		x, y= 32, 4
	[/filter]
	[message]
            speaker=talin
            message= _ "We can escape underground while orcs kill each other."
        [/message]
	 [endlevel]
            bonus=yes
            {NEW_GOLD_CARRYOVER 20}
        [/endlevel]
[/event]

    # Victory event when both warlords died.
    
    [event]
        name=enemies defeated

        [message]
            speaker=talin
            message= _ "<i>Yes</i>! We did it! We are free!"
        [/message]

        [move_unit_fake]
            type=Orcish Grunt
            side=3
            x=35,33
            y=16,16
        [/move_unit_fake]

        [unit]
            type=Orcish Grunt
            name= _ "Tavro"
            id=tavro
            side=3
            x,y=33,16
        [/unit]

        [message]
            speaker=tavro
            message= _ "Garrugch failed in mission, but Al’tar dead by peasant slaves."
        [/message]

        [message]
            speaker=tavro
            message= _ "We needs more meat for wolves. Peasants good meat."
        [/message]

        [kill]
            id=tavro
        [/kill]

        [move_unit_fake]
            type=Orcish Grunt
            side=3
            x=33,35
            y=16,16
        [/move_unit_fake]
	[endlevel]
            bonus=yes
            {NEW_GOLD_CARRYOVER 40}
        [/endlevel]
       
    [/event]

    # Death events

    # Death of Tallin. Equals defeat.
    [event]
        name=last breath
        [filter]
            id=talin
        [/filter]

        [message]
            speaker=talin
            message= _ "I die now, you orcish scum, but I die free! More will come after me. We will rise again until our vengeance has wiped your stain from our land!"
        [/message]
    [/event]

    [event]
        name=die
        [filter]
            id=talin
        [/filter]

        [message]
            speaker="Al'Tar"
            message= _ "Pah! Grunts, put the rest of that peasant rabble back in chains."
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id="Al'Tar"
        [/filter]

        [switch]
            variable=second_unit.race
            [case]
                value="human"
                [message]
                    speaker=unit
                    message= _ "What the...? (<i>Gurgle</i>) Killed... by... slaves?"
                [/message]
                [message]
                    speaker=second_unit
                    message= _ "(<i>Stab</i>)"
                [/message]	
		
            [/case]
            [case]
                value="orc"
                [message]
                    speaker=unit
                    message= _ "What the...? (<i>Gurgle</i>) Defeated... by... a grunt?"
                [/message]
                [message]
                    speaker=second_unit
                    message= _ "(<i>Stab</i>)"
                [/message]
            [/case]
            # In the immensely improbable possibility a troll kills him.
            [else]
                [message]
                    speaker=second_unit
                    message= _ "(<i>Smack</i>)"
                [/message]
            [/else]
        [/switch]

        [message]
            speaker=unit
            message= _ "Ugh!"
        [/message]

    [/event]

    [event]
        name=die
        [filter]
            id="Al'Tar"
        [/filter]

        [switch]
            variable=second_unit.race
            [case]
                value="human"
                [message]
                    speaker=second_unit
                    message= _ "Not a very bright one, was he?"
                [/message]
            [/case]
            [case]
                value="orc"
                [if]
                    [have_unit]
                        side=3
                        id=Garrugch
                    [/have_unit]
                    [then]
                        [message]
                            speaker=second_unit
                            #po: "him" is referring to Al'Tar
                            message= _ "We got him, chief!"
                        [/message]
                    [/then]
                    [else]
                        [message]
                            speaker=second_unit
                            message= _ "We avenged our leader..."
                        [/message]
                    [/else]
                [/if]
            [/case]
            [else][/else]
        [/switch]
	[if]
					[have_unit]
                       				side=3
                   				id=Garrugch
                   			 [/have_unit]
					[then]
						[message]
           						 speaker=Garrugch
           						 message= _ "Now Bloody Sword control Dwarven doors."
     						[/message]
					[/then]
					[else]
						[set_achievement]
							content_for=nro
							id=kill_slaver
						[/set_achievement]
					[/else]
	[/if]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Garrugch
        [/filter]

        [message]
            speaker=unit
            message= _ "No! I have failed in my mission!"
        [/message]
	[if]
					[have_unit]
                       				side=2
                   				id="Al'Tar"

                   			 [/have_unit]
					[then]
						[message]
           						 speaker="Al'Tar"
           						 message= _ "Only fools chalenge Al Tar."
     						[/message]
					[/then]
					[else]
						[set_achievement]
							content_for=nro
							id=kill_slaver
						[/set_achievement]
					[/else]
	[/if]

    [/event]

    [event]
        name=die
        [filter]
            id=Garrugch
        [/filter]

        [message]
            speaker=second_unit
            message= _ "Mission? What mission?"
        [/message]
    [/event]

    [event]
        name=time over
        [message]
            speaker= narrator
            message= _ "Sounds of drums and horns echo on the mountainsides. A large orc army draws near!"
        [/message]

        [message]
            speaker=talin
            message= _ "If only we were faster escaping into the mines this wouldn’t have happened. At least we will die free..."
        [/message]
    [/event]

[/scenario]
